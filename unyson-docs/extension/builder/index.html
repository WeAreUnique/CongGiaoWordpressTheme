<!DOCTYPE html>
<!--[if lt IE 8 ]><html lang="en" class="no-js oldie"><![endif]-->
<!--[if IE 8 ]><html lang="en" class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html lang="en" class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html lang="en" class="no-js"><!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Builder &mdash; Unyson Framework  documentation</title>

    <link rel="shortcut icon" href="../../_static/favicon.ico"/>

    

    
    
        <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    
        <link rel="stylesheet" href="../../_static/css/pygments.theme.css" type="text/css" />
    
        <link rel="stylesheet" href="../../_static/css/animate.css" type="text/css" />
    

    
    
    <!--<link rel="stylesheet" href="https://media.readthedocs.org/css/badge_only.css" type="text/css" />-->
    

    <link rel="stylesheet" href="../../_static/css/styles.css" type="text/css" />
            <link rel="index" title="Index" href="../../genindex.html"/>
            <link rel="search" title="Search" href="../../search.html"/>
        <link rel="top" title="Unyson Framework  documentation" href="../../index.html"/>
            <link rel="up" title="Built-in Extensions" href="../index.html"/>
            <link rel="next" title="Feedback" href="../feedback/index.html"/>
            <link rel="prev" title="Social" href="../social/index.html"/>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT: '../../',
            VERSION: '',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE: 'true'
        };
    </script>

    <!--[if lt IE 9]><script src="../../_static/js/respond.min.js"></script><![endif]-->

    <script type="text/javascript">
        var tfVars = {
            'logo_src': "../../_static/img/logo.png",
            'header_bg_src': "../../_static/img/header-bg.jpg"
        };
    </script>

    
        <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../_static/js/jquery.slicknav.min.js"></script>
        <script type="text/javascript" src="../../_static/js/scripts.js"></script>
        <script type="text/javascript" src="//use.typekit.net/dmy3vly.js"></script>
        <script type="text/javascript">try{ Typekit.load(); }catch(e){}</script>
     
</head>

<body>
    <a id="banner-bitblox"
   href="http://www.bitblox.me/?utm_source=unyson&utm_medium=banner&utm_campaign=unyson"
   target="_blank"><img src="../../_static/img/bitblox.jpg" alt="Bitblox">
</a>

<header id="masthead" class="site-header">
    <!-- Logo & Menu -->
    <div class="header">
        <div class="container">
            <div class="row">
                <div class="col-md-16">
                    <div class="site-logo invisible"><a href="http://unyson.io/"><img src="../../_static/img/unyson-logo.png" alt="" ></a></div>
					
					<nav id="primary-navigation" class="site-navigation primary-navigation invisible" role="navigation">
						<ul class="nav-menu clearfix">
							<li>
								<a href="http://unyson.io/">Unyson</a>
								<ul>
									<li><a href="http://unyson.io/#section-extensions"><i class="icon-matrix"></i>extensions<span>Built in extensions</span></a></li>
									<li><a href="http://unyson.io/#parallax3"><i class="icon-gear"></i>test unyson<span>Try it for free</span></a></li>
									<li><a href="http://unyson.io/#section-download"><i class="icon-unyson"></i>Get Unyson<span>WP Framework</span></a></li>
								</ul>
							</li>
							<li>
								<a target="_blank" href="http://demo.unyson.io">Scratch Theme</a>
								<ul>
									<li><a target="_blank" href="http://demo.unyson.io"><i class="icon-notebook"></i>Live demo<span>Check it out</span></a></li>
									<li><a target="_blank" href="https://github.com/ThemeFuse/Scratch-Theme/releases/latest"><i class="icon-download"></i>Get Theme<span>Scratch Theme</span></a></li>
								</ul>
							</li>
							<li class="active">
								<a href="http://manual.unyson.io/en/latest/">Support</a>
								<ul>
									<li><a href="http://manual.unyson.io/en/latest/"><i class="icon-tools"></i>Dev Manual<span>Develop themes</span></a></li>
									<li class="menu-submit-request"><a target="_blank" href="https://github.com/ThemeFuse/Unyson/issues"><i class="icon-support-1"></i>Post a ticket<span>Ask us a question</span></a></li>
								</ul>
							</li>
							
							<!--<li class="divider"><span>|</span></li>
							<li>
								<a href="http://docs.unyson.io/login">DOCS Creator</a>
								<ul>
									<li><a href="http://docs.unyson.io/login"><i class="icon-register"></i>Register<span>Create an account</span></a></li>
									<li><a href="http://docs.unyson.io/login"><i class="icon-login"></i>Login<span>Create/Edit docs</span></a></li>
									</ul>
								</li>-->  
								<!--<li>
									<a href="http://docs.unyson.io/login">Account</a>
									<ul>
										<li><a href="http://docs.unyson.io/login"><i class="icon-register"></i>Register<span>Create an account</span></a></li>
										<li><a href="http://docs.unyson.io/login"><i class="icon-login"></i>Login<span>Download themes</span></a></li>
									</ul>
								</li>-->
							</ul>
						</nav>
                </div>
            </div>
        </div>
    </div>
    <!--/ Logo & Menu -->
</header>

<!-- Main Header -->
<section class="main-header margin-bottom-60">
    <!-- Loading Spinner -->
    <div class="spinner">
        <div class="wBall" id="wBall_1">
            <div class="wInnerBall">
            </div>
        </div>
        <div class="wBall" id="wBall_2">
            <div class="wInnerBall">
            </div>
        </div>
        <div class="wBall" id="wBall_3">
            <div class="wInnerBall">
            </div>
        </div>
        <div class="wBall" id="wBall_4">
            <div class="wInnerBall">
            </div>
        </div>
        <div class="wBall" id="wBall_5">
            <div class="wInnerBall">
            </div>
        </div>
    </div>
    <!--/ Loading Spinner -->

    <div class="page-header invisible" style="background-image: url(../../_static/img/header-bg.jpg);">
        <div class="page-title-block">
            <div class="page-title-before invisible">Need help in the process of creating your own WordPress theme?</div>
            <h1 class="page-title invisible">Check out our extended</h1>
            <h2 class="page-subtitle invisible">Developer Manual</h2>
            <form accept-charset="UTF-8" action="../../search.html" id="search-form" class="invisible" method="get" role="search">
    <input id="query" class="query" name="q" placeholder="Search" type="search" autocomplete="off">
    <button id="search-submit" type="submit"><i class="icon-search"></i></button>
</form>
        </div>
    </div>
</section>
<!-- Main Header -->









    <div id="content-anchor">
        <a name="content"></a>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-lg-offset-2">
                <div class="row" id="before-content">
                    <div class="col-sm-12">
                        <nav class="clearfix">
                            <ol id="breadcrumbs">
                                <li><a href="../../index.html">Unyson Framework</a></li>

                                
                                <li><a href="../index.html">Built-in Extensions</a></li>
                                

                                <li>Builder</li>
                            </ol>
                        </nav>
                    </div>
                    <div class="col-sm-4">
                        
<div class="versions">
    <div class="current-version">
        <span>latest version</span>
        <div class="other-versions hidden">
            <dl>
                <dt>Versions:</dt>
                <dd><a href="/en/latest/">Latest</a>,</dd>
                <dd><a href="/en/latest/">0.6.1</a></dd>
            </dl>
            <dl>
                <dt>Downloads:</dt>
                <dd><a href="https://media.readthedocs.org/pdf/generity/latest/generity.pdf">PDF</a>,</dd>
                <dd><a href="https://media.readthedocs.org/htmlzip/generity/latest/generity.zip">HTML</a>,</dd>
                <dd><a href="https://media.readthedocs.org/epub/generity/latest/generity.epub">Epub</a></dd>
            </dl>
            <dl>
                <dt>On Read the Docs:</dt>
                <dd>
                    <a href="//readthedocs.org/projects/generity/?fromdocs=generity">Project Home</a>,
                </dd>
                <dd>
                    <a href="//readthedocs.org/builds/generity/?fromdocs=generity">Builds</a>
                </dd>
            </dl>
            <div class="sign">Hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.</div>
        </div>
    </div>
</div>

<script type="text/javascript">
    jQuery(function($){
        $(".current-version").hover(function(){
            var $this = $(this),
                dropdown = $this.children(".other-versions");

            dropdown.removeClass('hidden animated fadeOutUpSmall fadeInDownSmall');

            var menuItemWidth = $this.outerWidth(),
                submenuItemWidth = dropdown.outerWidth();

            dropdown.css('left' , (menuItemWidth-submenuItemWidth)/2);

            dropdown.addClass('animated fadeInDownSmall').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
                dropdown.removeClass('animated fadeInDownSmall');
            });
        }, function(){
            var $this = $(this),
                dropdown = $this.children(".other-versions");

            dropdown.addClass('animated fadeOutUpSmall').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
                $(this).removeClass('animated fadeOutUpSmall').addClass('hidden');
            });
        });
    });
</script>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div id="body">
                            
  <div class="section" id="builder">
<h1>Builder<a class="headerlink" href="#builder" title="Permalink to this headline">¶</a></h1>
<p>This extension provides the core builder functionality that you can extend to create new builders.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#changing-the-grid" id="id1">Changing the grid</a><ul>
<li><a class="reference internal" href="#changing-the-grid-for-all-builders" id="id2">Changing the grid for all builders</a></li>
<li><a class="reference internal" href="#changing-the-grid-for-one-builder" id="id3">Changing the grid for one builder</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-builder" id="id4">The Builder</a><ul>
<li><a class="reference internal" href="#data-structure" id="id5">Data Structure</a></li>
<li><a class="reference internal" href="#creating-a-builder" id="id6">Creating a Builder</a></li>
<li><a class="reference internal" href="#creating-items" id="id7">Creating Items</a><ul>
<li><a class="reference internal" href="#registering-items-in-javascript" id="id8">Registering items in javascript</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generate-custom-value" id="id9">Generate Custom Value</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="changing-the-grid">
<h2><a class="toc-backref" href="#contents">Changing the grid</a><a class="headerlink" href="#changing-the-grid" title="Permalink to this headline">¶</a></h2>
<p>By default the Builder uses a <a class="reference external" href="https://github.com/ThemeFuse/Unyson-Builder-Extension/blob/master/static/css/frontend-grid.css">bootstrap like grid</a>, with the same class names but prefixed with <code class="docutils literal"><span class="pre">.fw-{bootstrap-class-name}</span></code>.
The grid css is enqueued in all frontend pages from <code class="docutils literal"><span class="pre">framework/extensions/builder/static.php</span></code>.
Also this extension defines the grid columns for all builders (for e.g. <code class="docutils literal"><span class="pre">page-builder</span></code> and <code class="docutils literal"><span class="pre">form-builder</span></code>) in <code class="docutils literal"><span class="pre">framework/extensions/builder/config.php</span></code>.</p>
<div class="section" id="changing-the-grid-for-all-builders">
<h3><a class="toc-backref" href="#contents">Changing the grid for all builders</a><a class="headerlink" href="#changing-the-grid-for-all-builders" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Overwrite <code class="docutils literal"><span class="pre">framework/extensions/builder/config.php</span></code> by creating <code class="docutils literal"><span class="pre">{theme}/framework-customizations/extensions/builder/config.php</span></code></p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;FW&#39;</span><span class="p">))</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Forbidden&#39;</span><span class="p">);</span>

<span class="nv">$cfg</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>

<span class="nv">$cfg</span><span class="p">[</span><span class="s1">&#39;default_item_widths&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="sd">/**</span>
<span class="sd">     * Copy/Paste here default columns https://github.com/ThemeFuse/Unyson-Builder-Extension/blob/master/config.php</span>
<span class="sd">     * and add, remove or change them</span>
<span class="sd">     */</span>
<span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Prevent default grid css enqueue and enqueue your own css.
Create <code class="docutils literal"><span class="pre">{theme}/framework-customizations/extensions/builder/static.php</span></code></p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;FW&#39;</span><span class="p">))</span> <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Forbidden&#39;</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_admin</span><span class="p">())</span> <span class="p">{</span>
    <span class="nx">wp_register_style</span><span class="p">(</span>
        <span class="s1">&#39;fw-ext-builder-frontend-grid&#39;</span><span class="p">,</span>
        <span class="nx">get_template_directory_uri</span><span class="p">()</span> <span class="o">.</span><span class="s1">&#39;/framework-customizations/extensions/builder/static/frontend-grid.css&#39;</span><span class="p">,</span>
        <span class="k">array</span><span class="p">(),</span>
        <span class="nx">fw</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">theme</span><span class="o">-&gt;</span><span class="na">manifest</span><span class="o">-&gt;</span><span class="na">get_version</span><span class="p">()</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="changing-the-grid-for-one-builder">
<h3><a class="toc-backref" href="#contents">Changing the grid for one builder</a><a class="headerlink" href="#changing-the-grid-for-one-builder" title="Permalink to this headline">¶</a></h3>
<p>Other extensions use the <code class="docutils literal"><span class="pre">fw_ext_builder_get_item_width($builder_type,</span> <span class="pre">$width_id)</span></code> function to get and output grid css class in frontend</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;&lt;?php echo esc_attr(fw_ext_builder_get_item_width(&#39;page-builder&#39;, &#39;1_2/frontend_class&#39;)) ?&gt;&quot;</span> <span class="o">&gt;</span>
</pre></div>
</div>
<p>The function loads the grid from config, but allows you to change it via <a class="reference external" href="https://github.com/ThemeFuse/Unyson-Builder-Extension/blob/f57ebc5623407277f1c2d22365fe0a74cff22b36/helpers.php#L22-L24">this filter</a>.
You can use the filter to change the grid columns for some builder type.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="nx">add_filter</span><span class="p">(</span>
    <span class="s1">&#39;fw_builder_item_widths:page-builder&#39;</span><span class="p">,</span>
    <span class="s1">&#39;_filter_theme_custom_page_builder_columns&#39;</span>
<span class="p">);</span>
<span class="k">function</span> <span class="nf">_filter_theme_custom_page_builder_columns</span><span class="p">(</span><span class="nv">$columns</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$columns</span><span class="p">[</span><span class="s1">&#39;3_7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;3/7&#39;</span><span class="p">,</span>
        <span class="s1">&#39;backend_class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;custom-backend-3-7-column&#39;</span><span class="p">,</span> <span class="c1">// you must enqueue in backend a css with this class</span>
        <span class="s1">&#39;frontend_class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;frontend-custom-3-7-column&#39;</span><span class="p">,</span> <span class="c1">// you must enqueue in frontend a css with this class</span>
    <span class="p">);</span>

    <span class="k">return</span> <span class="nv">$columns</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-builder">
<h2><a class="toc-backref" href="#contents">The Builder</a><a class="headerlink" href="#the-builder" title="Permalink to this headline">¶</a></h2>
<p>The builder is just an <a class="reference internal" href="../../options/option-types.html"><span class="doc">option type</span></a>.
But you can’t use it right away, because it’s too abstract and doesn’t have any concrete purpose.
You can only extend it and create new builders based on it.</p>
<div class="section" id="data-structure">
<h3><a class="toc-backref" href="#contents">Data Structure</a><a class="headerlink" href="#data-structure" title="Permalink to this headline">¶</a></h3>
<p>The javascript side of the builder is based on <a class="reference external" href="http://backbonejs.org/">backbone</a>,
so it uses collections and models to store the data:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
        <span class="nx">_items</span><span class="o">:</span> <span class="p">[],</span>
        <span class="nx">attr_x</span><span class="o">:</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
        <span class="nx">_items</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="p">...},</span> <span class="p">...</span> <span class="p">],</span>
        <span class="nx">attr_y</span><span class="o">:</span> <span class="s1">&#39;Hi&#39;</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Every model (also called item) has a required attribute <code class="docutils literal"><span class="pre">type</span></code>.
Also it has an attribute <code class="docutils literal"><span class="pre">_items</span></code> that is generated automatically
by the <a class="reference external" href="http://backbonerelational.org/">backbone-relational</a> plugin,
the purpose of which is to make possible to have nested items easier.
There are no rules for other attributes, every item has whatever attributes it wants.</p>
<p>The same data structure is used on the php side,
this collection is simply transformed into an array with <code class="docutils literal"><span class="pre">json_decode($collection,</span> <span class="pre">true)</span></code>.</p>
</div>
<div class="section" id="creating-a-builder">
<h3><a class="toc-backref" href="#contents">Creating a Builder</a><a class="headerlink" href="#creating-a-builder" title="Permalink to this headline">¶</a></h3>
<p>This tutorial will explain you how to create a simple demo builder for html <code class="docutils literal"><span class="pre">&lt;ul&gt;</span></code> and <code class="docutils literal"><span class="pre">&lt;ol&gt;</span></code> lists.
First, <a class="reference internal" href="../../options/create-option-type.html"><span class="doc">create an option type</span></a> that extends the builder option type:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1">// file: theme/inc/includes/option-types/lists-builder/class-fw-option-type-lists-builder.php</span>

<span class="k">class</span> <span class="nc">FW_Option_Type_Lists_Builder</span> <span class="k">extends</span> <span class="nx">FW_Option_Type_Builder</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">get_type</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;lists-builder&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">FW_Option_Type</span><span class="o">::</span><span class="na">register</span><span class="p">(</span><span class="s1">&#39;FW_Option_Type_Lists_Builder&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>That’s it, the new builder was created. Use it in your post options to see what it shows at this point.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example assumes that you use in your theme <a class="reference external" href="https://github.com/ThemeFuse/Theme-Includes#directory-structure">this directory structure</a>.</p>
</div>
<ol class="arabic">
<li><p class="first">Include the option type:</p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1">// file: theme/inc/includes/lists-builder.php</span>

<span class="sd">/** @internal */</span>
<span class="k">function</span> <span class="nf">_action_include_demo_lists_builder</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fw_ext</span><span class="p">(</span><span class="s1">&#39;builder&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="sd">/**</span>
<span class="sd">         * Lists Builder requires the FW_Option_Type_Builder class</span>
<span class="sd">         * which does not exist if the &#39;builder&#39; extension is not active.</span>
<span class="sd">         *</span>
<span class="sd">         * You can install and activate the &#39;builder&#39; extension by installing any extension that uses it,</span>
<span class="sd">         * for e.g. Page Builder or Learning (which has the Learning Quiz Builder sub-extension)</span>
<span class="sd">         */</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">require_once</span> <span class="nb">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;/option-types/lists-builder/class-fw-option-type-lists-builder.php&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">add_action</span><span class="p">(</span><span class="s1">&#39;fw_option_types_init&#39;</span><span class="p">,</span> <span class="s1">&#39;_action_include_demo_lists_builder&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Add it in post options:</p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1">// file: theme/framework-customizations/theme/options/posts/post.php</span>

<span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;lists-builder-box&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Lists Builder&#39;</span><span class="p">,</span> <span class="s1">&#39;{domain}&#39;</span><span class="p">),</span>
        <span class="s1">&#39;options&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;lists-builder&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;lists-builder&#39;</span><span class="p">,</span>

                <span class="c1">// this will make it full width</span>
                <span class="s1">&#39;label&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Go to <code class="docutils literal"><span class="pre">your.site/wp-admin/edit.php</span></code> page, open any post edit page and look for the “Lists Builder” box.</p>
</li>
</ol>
<p>As you can see, the box is empty. At least you’ve successfully created the builder, now you can improve it.</p>
</div>
<div class="section" id="creating-items">
<h3><a class="toc-backref" href="#contents">Creating Items</a><a class="headerlink" href="#creating-items" title="Permalink to this headline">¶</a></h3>
<p>To build lists you’ll need the following elements: <code class="docutils literal"><span class="pre">&lt;ul&gt;</span></code>, <code class="docutils literal"><span class="pre">&lt;ol&gt;</span></code> and <code class="docutils literal"><span class="pre">&lt;li&gt;</span></code>.
In builder these elements can be created as item types.
The <code class="docutils literal"><span class="pre">&lt;ul&gt;</span></code> and <code class="docutils literal"><span class="pre">&lt;ol&gt;</span></code> (containers for <code class="docutils literal"><span class="pre">&lt;li&gt;</span></code>) will be created as one item type (with sub types), and <code class="docutils literal"><span class="pre">&lt;li&gt;</span></code> as another item type.
To create item types for a builder type you have to:</p>
<ol class="arabic">
<li><p class="first">Find out what item types the builder accepts.</p>
<blockquote>
<div><p>That information can be found in the <code class="docutils literal"><span class="pre">FW_Option_Type_Builder::item_type_is_valid()</span></code> method.
The builder you created above doesn’t have a custom <code class="docutils literal"><span class="pre">item_type_is_valid()</span></code> method, so it is inherited from the extended class,
and that method looks like this:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="sd">/**</span>
<span class="sd"> * Overwrite this method to force your builder type items to extend custom class or to have custom requirements</span>
<span class="sd"> * @param FW_Option_Type_Builder_Item $item_type_instance</span>
<span class="sd"> * @return bool</span>
<span class="sd"> */</span>
<span class="k">protected</span> <span class="k">function</span> <span class="nf">item_type_is_valid</span><span class="p">(</span><span class="nv">$item_type_instance</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">is_subclass_of</span><span class="p">(</span><span class="nv">$item_type_instance</span><span class="p">,</span> <span class="s1">&#39;FW_Option_Type_Builder_Item&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Register item types.</p>
<blockquote>
<div><p>Create and register item type that will represent the <code class="docutils literal"><span class="pre">&lt;ul&gt;</span></code> and <code class="docutils literal"><span class="pre">&lt;ol&gt;</span></code> elements:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1">// file: theme/inc/includes/option-types/lists-builder/item-types/oul/class-fw-lists-builder-item-type-oul.php</span>

<span class="k">class</span> <span class="nc">FW_Lists_Builder_Item_Type_OUl</span> <span class="k">extends</span> <span class="nx">FW_Option_Type_Builder_Item</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * Specify which builder type this item type belongs to</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">get_builder_type</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;lists-builder&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * The item type</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">get_type</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;oul&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * The boxes that appear on top of the builder and can be dragged down or clicked to create items</span>
<span class="sd">     * @return array</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">get_thumbnails</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;html&#39;</span> <span class="o">=&gt;</span>
                    <span class="s1">&#39;&lt;div class=&quot;item-type-icon-title&quot; data-sub-type=&quot;ul&quot;&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;    &lt;div class=&quot;item-type-icon&quot;&gt;&amp;lt;ul&amp;gt;&lt;/div&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;    &lt;div class=&quot;item-type-title&quot;&gt;&#39;</span><span class="o">.</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Unordered List&#39;</span><span class="p">,</span> <span class="s1">&#39;{domain}&#39;</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;html&#39;</span> <span class="o">=&gt;</span>
                    <span class="s1">&#39;&lt;div class=&quot;item-type-icon-title&quot; data-sub-type=&quot;ol&quot;&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;    &lt;div class=&quot;item-type-icon&quot;&gt;&amp;lt;ol&amp;gt;&lt;/div&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;    &lt;div class=&quot;item-type-title&quot;&gt;&#39;</span><span class="o">.</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Ordered List&#39;</span><span class="p">,</span> <span class="s1">&#39;{domain}&#39;</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Enqueue item type scripts and styles</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">enqueue_static</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">FW_Option_Type_Builder</span><span class="o">::</span><span class="na">register_item_type</span><span class="p">(</span><span class="s1">&#39;FW_Lists_Builder_Item_Type_OUl&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Create and register item type that will represent the <code class="docutils literal"><span class="pre">&lt;li&gt;</span></code> element:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1">// file: theme/inc/includes/option-types/lists-builder/item-types/li/class-fw-lists-builder-item-type-li.php</span>

<span class="k">class</span> <span class="nc">FW_Lists_Builder_Item_Type_Li</span> <span class="k">extends</span> <span class="nx">FW_Option_Type_Builder_Item</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">get_builder_type</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;lists-builder&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">get_type</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;li&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">get_thumbnails</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
            <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;html&#39;</span> <span class="o">=&gt;</span>
                    <span class="s1">&#39;&lt;div class=&quot;item-type-icon-title&quot;&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;    &lt;div class=&quot;item-type-icon&quot;&gt;&amp;lt;li&amp;gt;&lt;/div&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;    &lt;div class=&quot;item-type-title&quot;&gt;List Item&lt;/div&gt;&#39;</span><span class="o">.</span>
                    <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">enqueue_static</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">FW_Option_Type_Builder</span><span class="o">::</span><span class="na">register_item_type</span><span class="p">(</span><span class="s1">&#39;FW_Lists_Builder_Item_Type_Li&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Include the created files.</p>
<blockquote>
<div><p>At the end of the <code class="docutils literal"><span class="pre">_action_include_demo_lists_builder()</span></code> function (created above), add:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="c1">// file: theme/inc/includes/lists-builder.php</span>

<span class="k">function</span> <span class="nf">_action_include_demo_lists_builder</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">...</span>

    <span class="k">require_once</span> <span class="nb">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;/option-types/lists-builder/item-types/oul/class-fw-lists-builder-item-type-oul.php&#39;</span><span class="p">;</span>
    <span class="k">require_once</span> <span class="nb">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">)</span> <span class="o">.</span><span class="s1">&#39;/option-types/lists-builder/item-types/li/class-fw-lists-builder-item-type-li.php&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>Refresh the page and you should see three boxes that can be dragged down.
Unfortunately you will get an error in console saying that the item type is not registered.
This happens because you also have to register the item type in javascript and define how it works and looks in builder.</p>
<div class="section" id="registering-items-in-javascript">
<h4><a class="toc-backref" href="#contents">Registering items in javascript</a><a class="headerlink" href="#registering-items-in-javascript" title="Permalink to this headline">¶</a></h4>
<p>Registering builder items can be done via the <code class="docutils literal"><span class="pre">builderInstance.registerItemClass(ItemTypeClass)</span></code> method.
Because <code class="docutils literal"><span class="pre">builderInstance</span></code> is created somewhere in builder scripts and it’s not a global variable,
the only way to get it, is to listen special event <code class="docutils literal"><span class="pre">fw-builder:{builder-type}:register-items</span></code>.</p>
<ol class="arabic">
<li><p class="first">Create the scripts file that registers the <code class="docutils literal"><span class="pre">oul</span></code> item type:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// file:: theme/inc/includes/option-types/lists-builder/item-types/oul/static/scripts.js</span>

<span class="nx">fwEvents</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;fw-builder:&#39;</span><span class="o">+</span> <span class="s1">&#39;lists-builder&#39;</span> <span class="o">+</span><span class="s1">&#39;:register-items&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ItemClass</span> <span class="o">=</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">classes</span><span class="p">.</span><span class="nx">Item</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">defaults</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;oul&#39;</span> <span class="c1">// the item type is specified here</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">builder</span><span class="p">.</span><span class="nx">registerItemClass</span><span class="p">(</span><span class="nx">ItemClass</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Enqueue the <code class="docutils literal"><span class="pre">oul</span></code> item type scripts file:</p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FW_Lists_Builder_Item_Type_OUl</span> <span class="k">extends</span> <span class="nx">FW_Option_Type_Builder_Item</span>
<span class="p">{</span>
    <span class="o">...</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">enqueue_static</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nx">wp_enqueue_script</span><span class="p">(</span>
            <span class="s1">&#39;lists-builder-item-type-oul&#39;</span><span class="p">,</span>
            <span class="nx">get_template_directory_uri</span><span class="p">()</span> <span class="o">.</span><span class="s1">&#39;/inc/includes/option-types/lists-builder/item-types/oul/static/scripts.js&#39;</span><span class="p">,</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;fw-events&#39;</span><span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Create the scripts file that registers the <code class="docutils literal"><span class="pre">li</span></code> item type:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// file:: theme/inc/includes/option-types/lists-builder/item-types/li/static/scripts.js</span>

<span class="nx">fwEvents</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;fw-builder:&#39;</span><span class="o">+</span> <span class="s1">&#39;lists-builder&#39;</span> <span class="o">+</span><span class="s1">&#39;:register-items&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ItemClass</span> <span class="o">=</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">classes</span><span class="p">.</span><span class="nx">Item</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">defaults</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;li&#39;</span> <span class="c1">// the item type is specified here</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">builder</span><span class="p">.</span><span class="nx">registerItemClass</span><span class="p">(</span><span class="nx">ItemClass</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Enqueue the <code class="docutils literal"><span class="pre">li</span></code> item type scripts file:</p>
<blockquote>
<div><div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FW_Lists_Builder_Item_Type_Li</span> <span class="k">extends</span> <span class="nx">FW_Option_Type_Builder_Item</span>
<span class="p">{</span>
    <span class="o">...</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">enqueue_static</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nx">wp_enqueue_script</span><span class="p">(</span>
            <span class="s1">&#39;lists-builder-item-type-li&#39;</span><span class="p">,</span>
            <span class="nx">get_template_directory_uri</span><span class="p">()</span> <span class="o">.</span><span class="s1">&#39;/inc/includes/option-types/lists-builder/item-types/li/static/scripts.js&#39;</span><span class="p">,</span>
            <span class="k">array</span><span class="p">(</span><span class="s1">&#39;fw-events&#39;</span><span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>Refresh the page and try to click or drag down the boxes.
The items should appear in the builder, but they are using the default view and doesn’t have any concrete functionality.
At this point, you have a working builder.
If you add some items and save the post, after page refresh the builder will recover from the saved json value.
Customize the views and add some functionality to items to be able to build lists with them:</p>
<ol class="arabic">
<li><p class="first">Replace the <code class="docutils literal"><span class="pre">oul</span></code> item type scripts with:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// file: theme/inc/includes/option-types/lists-builder/item-types/oul/static/scripts.js</span>

<span class="nx">fwEvents</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;fw-builder:&#39;</span><span class="o">+</span> <span class="s1">&#39;lists-builder&#39;</span> <span class="o">+</span><span class="s1">&#39;:register-items&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ItemView</span> <span class="o">=</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">classes</span><span class="p">.</span><span class="nx">ItemView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span>
            <span class="s1">&#39;&lt;div style=&quot;border: 1px solid #ccc; padding: 0 10px;&quot;&gt;&#39;</span><span class="o">+</span>
                <span class="s1">&#39;&lt;p&gt;&amp;lt;&lt;span&gt;&lt;%- type %&gt;&lt;/span&gt;&amp;gt; &lt;a href=&quot;#&quot; onclick=&quot;return false;&quot; class=&quot;dashicons fw-x&quot;&gt;&lt;/a&gt;&lt;/p&gt;&#39;</span><span class="o">+</span>

                <span class="cm">/**</span>
<span class="cm">                 * Special element with &#39;builder-items&#39; class</span>
<span class="cm">                 * displays the items that are in the &#39;_items&#39; attribute of the model</span>
<span class="cm">                 */</span>
                <span class="s1">&#39;&lt;div class=&quot;builder-items&quot;&gt;&lt;!-- list items --&gt;&lt;/div&gt;&#39;</span><span class="o">+</span>
            <span class="s1">&#39;&lt;/div&gt;&#39;</span>
        <span class="p">),</span>
        <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="c1">// It is recommended to do the template render using this method</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">defaultRender</span><span class="p">({</span>
                <span class="nx">type</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;list_type&#39;</span><span class="p">)</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">ItemClass</span> <span class="o">=</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">classes</span><span class="p">.</span><span class="nx">Item</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">defaults</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;oul&#39;</span><span class="p">,</span> <span class="c1">// the item type is specified here</span>
            <span class="nx">list_type</span><span class="o">:</span> <span class="s1">&#39;ul&#39;</span>
        <span class="p">},</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">atts</span><span class="p">,</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">opts</span> <span class="o">&amp;&amp;</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">$thumb</span><span class="p">)</span> <span class="p">{</span>
                <span class="cm">/**</span>
<span class="cm">                 * When the item box is dragged down or clicked, opts.$thumb contains the box element</span>
<span class="cm">                 * so you can extract the data-sub-type attribute set in html.</span>
<span class="cm">                 *</span>
<span class="cm">                 * Note: opts.$thumb doesn&#39;t exist when the item is created from code</span>
<span class="cm">                 * for e.g. recovered from json after page refresh</span>
<span class="cm">                 */</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;list_type&#39;</span><span class="p">,</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">$thumb</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;[data-sub-type]&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data-sub-type&#39;</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ItemView</span><span class="p">({</span>
                <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;lists-builder-item-&#39;</span><span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">cid</span><span class="p">,</span>
                <span class="nx">model</span><span class="o">:</span> <span class="k">this</span>
            <span class="p">});</span>

            <span class="c1">// it is recommended to call this method</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">defaultInitialize</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="cm">/**</span>
<span class="cm">         * This method controls which item types are allowed to be added inside this item in the &#39;_items&#39; attribute</span>
<span class="cm">         * @param {String} type</span>
<span class="cm">         * @returns {boolean}</span>
<span class="cm">         */</span>
        <span class="nx">allowIncomingType</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">==</span> <span class="s1">&#39;li&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">builder</span><span class="p">.</span><span class="nx">registerItemClass</span><span class="p">(</span><span class="nx">ItemClass</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Replace the <code class="docutils literal"><span class="pre">li</span></code> item type scripts with:</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// file: theme/inc/includes/option-types/lists-builder/item-types/li/static/scripts.js</span>

<span class="nx">fwEvents</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;fw-builder:&#39;</span><span class="o">+</span> <span class="s1">&#39;lists-builder&#39;</span> <span class="o">+</span><span class="s1">&#39;:register-items&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">builder</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">ItemView</span> <span class="o">=</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">classes</span><span class="p">.</span><span class="nx">ItemView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span>
            <span class="s1">&#39;&lt;div style=&quot;border: 1px solid #ccc; padding: 0 10px;&quot;&gt;&#39;</span><span class="o">+</span>
            <span class="s1">&#39;&lt;p&gt;&#39;</span><span class="o">+</span>
                <span class="s1">&#39;&lt;span&gt;&lt;%= text %&gt;&lt;/span&gt; &#39;</span><span class="o">+</span>
                <span class="s1">&#39;&lt;a href=&quot;#&quot; onclick=&quot;return false;&quot; class=&quot;dashicons dashicons-edit&quot;&gt;&lt;/a&gt;&#39;</span><span class="o">+</span>
                <span class="s1">&#39;&lt;a href=&quot;#&quot; onclick=&quot;return false;&quot; class=&quot;dashicons fw-x&quot;&gt;&lt;/a&gt;&#39;</span><span class="o">+</span>
            <span class="s1">&#39;&lt;/p&gt;&#39;</span><span class="o">+</span>
            <span class="s1">&#39;&lt;/div&gt;&#39;</span>
        <span class="p">),</span>
        <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;click a.dashicons.fw-x&#39;</span><span class="o">:</span> <span class="s1">&#39;defaultRemove&#39;</span><span class="p">,</span>
            <span class="s1">&#39;click .dashicons-edit&#39;</span><span class="o">:</span> <span class="s1">&#39;openTextEdit&#39;</span>
        <span class="p">},</span>
        <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">defaultRender</span><span class="p">({</span>
                <span class="nx">text</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">openTextEdit</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;Edit &lt;li&gt; text&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">));</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">text</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="nx">text</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="kd">var</span> <span class="nx">ItemClass</span> <span class="o">=</span> <span class="nx">builder</span><span class="p">.</span><span class="nx">classes</span><span class="p">.</span><span class="nx">Item</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">defaults</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;li&#39;</span><span class="p">,</span> <span class="c1">// the item type is specified here</span>
            <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;Hello World!&#39;</span> <span class="c1">// &lt;li&gt;{text}&lt;/li&gt;</span>
        <span class="p">},</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">atts</span><span class="p">,</span> <span class="nx">opts</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ItemView</span><span class="p">({</span>
                <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;lists-builder-item-&#39;</span><span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">cid</span><span class="p">,</span>
                <span class="nx">model</span><span class="o">:</span> <span class="k">this</span>
            <span class="p">});</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">defaultInitialize</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="cm">/**</span>
<span class="cm">         * This method controls to which item types this item is allowed to be added/moved</span>
<span class="cm">         * @param {String} type</span>
<span class="cm">         * @returns {boolean}</span>
<span class="cm">         */</span>
        <span class="nx">allowDestinationType</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">==</span> <span class="s1">&#39;oul&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">builder</span><span class="p">.</span><span class="nx">registerItemClass</span><span class="p">(</span><span class="nx">ItemClass</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>Now the javascript side of the builder has the minimum functionality to be able to build lists.
After you build a list and saved the post, the html of the list needs to be generated so you can display it on the page.
To do that, continue to the next step.</p>
</div>
</div>
<div class="section" id="generate-custom-value">
<h3><a class="toc-backref" href="#contents">Generate Custom Value</a><a class="headerlink" href="#generate-custom-value" title="Permalink to this headline">¶</a></h3>
<p>By default the builder saves its value as an array with one key <code class="docutils literal"><span class="pre">json</span></code> which stores the original value used in javascript.
From the original value, you can generate any custom values and store them in custom keys.
In the case with Lists Builder, you have to generate the lists html from that original json value to be able to display the list in html.
This can achieved by overwriting the builder <code class="docutils literal"><span class="pre">_get_value_from_input()</span></code> method.</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FW_Option_Type_Lists_Builder</span> <span class="k">extends</span> <span class="nx">FW_Option_Type_Builder</span>
<span class="p">{</span>
    <span class="o">...</span>

    <span class="sd">/**</span>
<span class="sd">     * Generate the html of the list</span>
<span class="sd">     * {@inheritdoc}</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">_get_value_from_input</span><span class="p">(</span><span class="nv">$option</span><span class="p">,</span> <span class="nv">$input_value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$value</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">_get_value_from_input</span><span class="p">(</span><span class="nv">$option</span><span class="p">,</span> <span class="nv">$input_value</span><span class="p">);</span>

        <span class="nv">$html</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nb">json_decode</span><span class="p">(</span><span class="nv">$value</span><span class="p">[</span><span class="s1">&#39;json&#39;</span><span class="p">],</span> <span class="k">true</span><span class="p">)</span> <span class="k">as</span> <span class="nv">$list</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$html</span> <span class="o">.=</span> <span class="s1">&#39;&lt;&#39;</span><span class="o">.</span> <span class="nv">$list</span><span class="p">[</span><span class="s1">&#39;list_type&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$list</span><span class="p">[</span><span class="s1">&#39;_items&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$list_item</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$html</span> <span class="o">.=</span> <span class="s1">&#39;&lt;li&gt;&#39;</span><span class="o">.</span> <span class="nv">$list_item</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s1">&#39;&lt;/li&gt;&#39;</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$html</span> <span class="o">.=</span> <span class="s1">&#39;&lt;/&#39;</span><span class="o">.</span> <span class="nv">$list</span><span class="p">[</span><span class="s1">&#39;list_type&#39;</span><span class="p">]</span> <span class="o">.</span><span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$value</span><span class="p">[</span><span class="s1">&#39;html&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$html</span><span class="p">;</span>

        <span class="k">return</span> <span class="nv">$value</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now you can use the generated html in post template. Add to <code class="docutils literal"><span class="pre">theme/single.php</span></code>:</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="o">...</span>

<span class="k">while</span> <span class="p">(</span> <span class="nx">have_posts</span><span class="p">()</span> <span class="p">)</span> <span class="o">:</span> <span class="nx">the_post</span><span class="p">();</span>

    <span class="k">echo</span> <span class="nx">fw_get_db_post_option</span><span class="p">(</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;lists-builder/html&#39;</span> <span class="p">);</span>

<span class="o">...</span>
</pre></div>
</div>
<p>Congratulations, now you can create new builders!</p>
<p>There are many things that can be improved in the Lists Builder, but this article will become too big.
You can inspect <a class="reference external" href="https://github.com/ThemeFuse/Unyson-Builder-Extension/tree/master/includes/option-types/builder">the builder code</a>
and other builders like <a class="reference external" href="https://github.com/ThemeFuse/Unyson-PageBuilder-Extension/tree/master/includes/fw-option-type-page-builder">Page Builder</a>,
<a class="reference external" href="https://github.com/ThemeFuse/Unyson-Forms-Extension/tree/master/includes/option-types/form-builder">Forms Builder</a>
and <a class="reference external" href="https://github.com/ThemeFuse/Unyson-Learning-Extension/tree/master/extensions/learning-quiz/includes/option-types/quiz-builder">Learning Quiz Builder</a>
to find the answers for the questions that may appear while developing your own builder.</p>
</div>
</div>
</div>


                        </div>

                        
    <div class="pagination clearfix">
        
            <a href="../social/index.html" class="prev" ><i class="icon-arrow-left"></i> <span>Social</span></a>
        
        
            <a href="../feedback/index.html" class="next" ><span>Feedback</span> <i class="icon-arrow-right"></i></a>
        
    </div>

                    </div>
                    <div class="col-sm-4">
                        <div id="menu-wrapper">
                            <h3 class="menu-title">Developer Manual</h3>
                            <div id="menu">

                                <ul class="" id="custom-menu-top">
                                    <li class="toctree-l1"><a class="reference internal" href="../../index.html">Unyson Framework</a>
                                        <ul class="current">
                                            <li class="toctree-l2">
                                                <a class=" reference internal" href="../../index.html">Getting Started</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>

                                
                                
                                    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../convention/index.html">Convention</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../convention/general.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../convention/prefixes.html">Prefixes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../convention/directory-structure.html">Directory Structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../options/index.html">Options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../options/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../options/integrate.html">Theme Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../options/customizer.html">Customizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../options/option-types.html">Option Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../options/built-in/introduction.html">Built-in Option Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../options/create-option-type.html">Create Option Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../options/storage.html">Custom Save Location</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../extensions/index.html">Extensions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../extensions/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions/create-extension.html">Create Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions/cookbook.html">Cookbook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../components/index.html">Components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../components/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../components/theme.html">Theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../components/backend.html">Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../components/extensions.html">Extensions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../helpers/index.html">Helpers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../helpers/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../helpers/php.html">PHP Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../helpers/javascript.html">JavaScript Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../helpers/css.html">CSS Helpers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../manifest/index.html">Manifest</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../manifest/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../manifest/framework.html">Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../manifest/theme.html">Theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../manifest/extension.html">Extension</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Built-in Extensions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shortcodes/index.html">Shortcodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../slider/index.html">Slider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../megamenu/index.html">Mega Menu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sidebars/index.html">Sidebars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../portfolio/index.html">Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backups/index.html">Backup &amp; Demo Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../forms/index.html">Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../breadcrumbs/index.html">Breadcrumbs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seo/index.html">SEO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../events/index.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../social/index.html">Social</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../feedback/index.html">Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning/index.html">Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../translation/index.html">Translation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wp-shortcodes/index.html">WordPress Shortcodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hooks/index.html">Filters &amp; Actions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hooks/index.html#actions">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hooks/index.html#filters">Filters</a></li>
</ul>
</li>
</ul>

                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer id="footer" class="site-footer" role="contentinfo">
    <div class="container">
        <div class="row">
            <div class="col-md-16">
                <div class="copyright">
                    <p>
                            &copy; 2017 Unyson | Theming Fast & Easy <br>Developed by: <a target="_blank" href="http://themefuse.com">ThemeFuse</a>	Icons by: <a target="_blank" href="http://pixelkit.com">PixelKit</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

    
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-15832274-21']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>
     
</body>
</html>